import dotenv from "dotenv"
import { Bot } from "grammy"

dotenv.config()

const bot = new Bot(process.env.TOKEN)
const chatId = -1002084678955// Массив с сообщениями
const myMSG = [
  "<b>1.</b> Жизнь — это путешествие, и каждый трудный шаг ведёт к вершине, на которую стоит подняться.",
  "<b>2.</b> Неудачи — это не конец, а лишь очередной поворот на пути к успеху.",
  "<b>3.</b> Верь в себя, даже если весь мир сомневается в тебе.",
  "<b>4.</b> Помни, что каждый закат — это обещание нового рассвета.",
  "<b>5.</b> Все великие достижения начинаются с маленького, но смелого шага.",
  "<b>6.</b> Если что-то не идёт, как планировалось, возможно, пришло время пересмотреть план.",
  "<b>7.</b> Мы сильнее, чем думаем, и каждая трудность — это шанс увидеть, насколько мы крепки.",
  "<b>8.</b> Сомнения — это тень, а не преграда. Пройди сквозь неё к свету своих целей.",
  "<b>9.</b> Не бойся меняться. Иногда, чтобы найти своё счастье, нужно выйти за пределы привычного.",
  "<b>10.</b> Если мечты пугают тебя — это хороший знак. Значит, они достаточно велики.",
  "<b>11.</b> Сложности — это топливо для наших будущих побед.",
  "<b>12.</b> Даже самая долгая ночь заканчивается рассветом. Не останавливайся на пути к свету.",
  "<b>13.</b> Настоящая сила приходит не из побед, а из способности вставать после поражений.",
  "<b>14.</b> Не жди идеального момента, создавай его сам.",
  "<b>15.</b> Каждый трудный выбор — это шанс создать лучшую версию себя.",
  "<b>16.</b> Все ограничения — это лишь границы нашего сознания. Раздвинь их, и мир станет шире.",
  "<b>17.</b> Помни, что трудные времена — это временно, а уроки, которые ты из них извлекаешь, — навсегда.",
  "<b>18.</b> Не бойся быть другим. Уникальность — это дар, а не недостаток.",
  "<b>19.</b> Невозможно всегда быть на высоте, но можно всегда стремиться к этому.",
  "<b>20.</b> Самые тёмные моменты — это то, что помогает нам научиться ценить свет.",
  "<b>21.</b> Если ты чего-то очень хочешь, весь мир будет искать способы помочь тебе этого достичь.",
  "<b>22.</b> Каждый день — это новая возможность написать свою историю по-новому.",
  "<b>23.</b> Действуй с решимостью, и преграды уступят место возможностям.",
  "<b>24.</b> Не позволяй страху неудачи удерживать тебя от попытки.",
  "<b>25.</b> Наши ошибки — это учителя, которые помогают найти правильный путь.",
  "<b>26.</b> Не жди, когда станет легче. Начни прямо сейчас, и всё будет проще.",
  "<b>27.</b> Трудности закаляют характер, а победы — открывают двери к новым высотам.",
  "<b>28.</b> Мы создаём будущее своими мыслями, словами и действиями.",
  "<b>29.</b> Доверься своему сердцу и слушай интуицию, они не подведут.",
  "<b>30.</b> Неважно, сколько раз ты упал; важно, сколько раз ты поднялся.",
  "<b>31.</b> Каждое испытание — это возможность открыть в себе новые силы.",
  "<b>32.</b> Чтобы дойти до цели, нужно помнить, зачем ты начал свой путь.",
  "<b>33.</b> Уверенность в себе — ключ к успеху, но не бойся учиться и меняться.",
  "<b>34.</b> Дорога может быть длинной и трудной, но финишная черта того стоит.",
  "<b>35.</b> Секрет успеха — в постоянстве, а не в совершенности.",
  "<b>36.</b> Неудача — это ещё одна ступенька на лестнице к успеху.",
  "<b>37.</b> Каждый раз, когда тебе хочется сдаться, помни, ради чего ты начал.",
  "<b>38.</b> Даже если кажется, что всё рушится, это может быть лишь начало чего-то нового.",
  "<b>39.</b> Сомнения — это сигналы роста, значит, ты выходишь за пределы привычного.",
  "<b>40.</b> Стремись стать лучше, чем вчера, и ты уже на пути к победе.",
  "<b>41.</b> Жизнь всегда даёт второй шанс, если ты готов его принять.",
  "<b>42.</b> Цени свои усилия и гордись пройденным путём, даже если он был нелёгким.",
  "<b>43.</b> Если закрылась одна дверь, это не конец — просто нужно найти другую.",
  "<b>44.</b> Каждый шаг к цели важен, даже если он кажется маленьким.",
  "<b>45.</b> Вдохновение приходит к тем, кто продолжает идти, несмотря на страх и сомнения.",
  "<b>46.</b> Преграды на пути — это проверка, насколько сильно ты хочешь достигнуть своей мечты.",
  "<b>47.</b> Невозможно изменить прошлое, но ты можешь создать будущее.",
  "<b>48.</b> Боль временна, но победы и достижения останутся навсегда.",
  "<b>49.</b> Иногда самое тёмное время — это момент перед рассветом.",
  "<b>50.</b> Цени каждый день, ведь в нём скрыты возможности для роста и перемен."
];


// Функция для отправки случайного сообщения
async function sendMessage() {
	const randomMessage = myMSG[Math.floor(Math.random() * myMSG.length)] // Выбор случайной фразы
	await bot.api.sendMessage(chatId, randomMessage, {
		parse_mode: "HTML",
	})
}

// Обработчик запроса
export default async function handler(req, res) {
	// Проверка авторизации
	if (req.headers["authorization"] !== `Bearer ${process.env.CRON_SECRET}`) {
		return res.status(401).end("Unauthorized")
	}

	// Попытка отправить сообщение и ответить на запрос
	try {
		await sendMessage()
		res.status(200).end("Hello Cron! Сообщение отправлено.")
	} catch (error) {
		res.status(500).end("Ошибка при отправке сообщения.")
	}
}
